<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sjht.erp.workinfo.repository.WorkTimeManagerMapper">
    <select id="findWorkTimeInfo" resultType="sjht.erp.workinfo.dto.response.WorkInfoResponseDto"
            parameterType="sjht.erp.workinfo.dto.request.WorkInfoRequestDto">
        SELECT
        w.tano,
        w.empno,
        e.name,
        e.departmentcd,
        d.departmentname,
        w.registdate,
        w.startdate,
        w.enddate,
        w.approverdate,
        w.approver,
        w.approveryn
        FROM worktimemanagement w
        left join employee e
        on w.empno = e.empno
        left join departmentcode d
        on e.departmentcd = d.departmentcd

        <if test="approveryn !=''">
            where
            approveryn = (#{approveryn})
        </if>
        <if test="start != null and end != null">
            and(TIME(registdate) between #{start} and #{end})
        </if>
        <if test="name != ''">
            and e.name = (#{name})
        </if>
        <if test="empno != 0">
            and w.empno = (#{empno})
        </if>
        order by tano DESC
    </select>

</mapper>

